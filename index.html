<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>注音練習</title>
<style>
  body { font-family:"微軟正黑體", sans-serif; background:#FFF8E7; text-align:center; padding:20px;}
  h1 {color:#D2691E;}
  #word {font-size:50px; margin:30px 0;}
  #selected {font-size:40px; margin:20px 0; color:blue;}
  .btn {font-size:30px; margin:5px; padding:10px 15px; border-radius:10px; border:none; background-color:#FFB347; cursor:pointer;}
  .btn:hover {background-color:#FF8C00;}
  #feedback {font-size:30px; margin-top:20px;}
  #score {font-size:20px; margin-top:10px;}
</style>
</head>
<body>
<h1>注音練習</h1>
<div id="word">詞語</div>
<div id="selected"></div>
<div id="buttons"></div>
<div>
  <button onclick="submitAnswer()">提交</button>
  <button onclick="nextWord()">下一題</button>
  <button onclick="showHint()">提示首音</button>
</div>
<div id="feedback"></div>
<div id="score">連續答對：0 | 正確率：0%</div>

<script>
// 簡單字庫
const words = [
  {char:"爸爸", zhuyin:["ㄅㄚˋ","ㄅㄚ˙"]},
  {char:"媽媽", zhuyin:["ㄇㄚ","ㄇㄚ˙"]},
  {char:"貓咪", zhuyin:["ㄇㄠ","ㄇㄧ"]},
  {char:"蘋果", zhuyin:["ㄆㄧㄥˊ","ㄍㄨㄛˇ"]},
  {char:"小朋友", zhuyin:["ㄒㄧㄠˇ","ㄆㄥˊ","ㄧㄡˇ"]}
];

let current = 0;
let selected = [];
let total = 0;
let correctCount = 0;
let streak = 0;

// 全部注音音節，作為干擾來源
const allSyllables = ["ㄅㄚ˙","ㄅㄚˋ","ㄇㄚ","ㄇㄚ˙","ㄇㄠ","ㄇㄧ","ㄆㄧㄥˊ","ㄍㄨㄛˇ","ㄒㄧㄠˇ","ㄆㄥˊ","ㄧㄡˇ","ㄉㄚˋ","ㄅㄠˋ","ㄍㄚˋ","ㄊㄚ˙","ㄌㄧˇ"];

function nextWord(){
  selected = [];
  const index = Math.floor(Math.random()*words.length);
  current = index;
  document.getElementById("word").textContent = words[current].char;
  document.getElementById("selected").textContent = "";
  document.getElementById("feedback").textContent = "";
  createButtons();
}

function createButtons(){
  const btnDiv = document.getElementById("buttons");
  btnDiv.innerHTML = "";
  const correct = words[current].zhuyin;
  let options = [...correct];

  // 加入隨機干擾音節
  while(options.length < correct.length + 3){ // 干擾3個
    const rand = allSyllables[Math.floor(Math.random()*allSyllables.length)];
    if(!options.includes(rand)){
      options.push(rand);
    }
  }

  // 打亂順序
  options.sort(()=>Math.random()-0.5);

  options.forEach(symbol=>{
    const btn = document.createElement("button");
    btn.textContent = symbol;
    btn.className = "btn";
    btn.onclick = ()=>{selected.push(symbol); updateSelected();}
    btnDiv.appendChild(btn);
  });
}

function updateSelected(){
  document.getElementById("selected").textContent = selected.join(" ");
}

function submitAnswer(){
  const answer = selected.join(" ");
  const correct = words[current].zhuyin.join(" ");
  total++;
  if(answer === correct){
    streak++;
    correctCount++;
    document.getElementById("feedback").textContent="✅ 正確！";
    document.getElementById("feedback").style.color="green";
  } else {
    streak=0;
    document.getElementById("feedback").textContent=`❌ 錯誤，正確答案：${correct}`;
    document.getElementById("feedback").style.color="red";
  }
  updateScore();
}

function showHint(){
  document.getElementById("feedback").textContent = `提示首個注音：${words[current].zhuyin[0]}`;
  document.getElementById("feedback").style.color="blue";
}

function updateScore(){
  const rate = total>0?Math.round((correctCount/total)*100):0;
  document.getElementById("score").textContent = `連續答對：${streak} | 正確率：${rate}%`;
}

// 初始化
nextWord();
</script>
</body>
</html>
